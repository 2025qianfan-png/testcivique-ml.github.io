<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Test Rapide - Principes et valeurs de la République </title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Variables et reset */
        :root {
            --primary-blue: #004080;
            --primary-light-blue: #0066cc;
            --primary-yellow: #ffd633;
            --primary-light-yellow: #ffe066;
            --dark-gray: #333333;
            --medium-gray: #666666;
            --light-gray: #f5f7fa;
            --white: #ffffff;
            --green: #27ae60;
            --orange: #f39c12;
            --red: #e74c3c;
            --purple: #9b59b6;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.12);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            color: var(--dark-gray);
            background-color: var(--light-gray);
            line-height: 1.7;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            position: relative;
            touch-action: manipulation;
        }

        h1, h2, h3, h4, h5 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            line-height: 1.3;
            color: var(--primary-blue);
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .main-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-light-blue) 100%);
            color: var(--white);
            padding: 30px 0;
            text-align: center;
            box-shadow: var(--shadow);
            position: relative;
            flex-shrink: 0;
        }

        .main-header h1 {
            color: var(--white);
            font-size: 2.8rem;
            margin-bottom: 10px;
            word-wrap: break-word;
        }

        .main-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Navigation */
        .main-nav {
            background-color: var(--white);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 100;
            flex-shrink: 0;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            flex-wrap: wrap;
        }

        .logo {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--primary-blue);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
        }

        .logo i {
            color: var(--primary-yellow);
        }

        .nav-links {
            display: flex;
            gap: 30px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-links a {
            color: var(--dark-gray);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            position: relative;
            padding: 5px 0;
        }

        .nav-links a:hover {
            color: var(--primary-blue);
        }

        /* Login Section */
        .login-section {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            min-height: calc(100vh - 280px);
            position: relative;
            width: 100%;
            overflow-y: auto;
        }

        .login-wrapper {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            max-width: 100%;
            padding: 20px 0;
        }

        .login-card {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 50px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 500px;
            text-align: center;
            animation: fadeIn 0.5s ease-out;
            margin: auto;
            box-sizing: border-box;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-icon {
            font-size: 3.5rem;
            color: var(--primary-blue);
            margin-bottom: 20px;
        }

        .login-card h2 {
            margin-bottom: 10px;
            font-size: 2rem;
            word-wrap: break-word;
        }

        .login-card p {
            color: var(--medium-gray);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 25px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-blue);
            font-size: 1rem;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Open Sans', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
            box-sizing: border-box;
            -webkit-appearance: none;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(0, 64, 128, 0.1);
        }

        .error-message {
            color: var(--red);
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* Test Type Selection */
        .test-selection {
            padding: 60px 0;
            background-color: var(--white);
            display: none;
        }

        .selection-title {
            text-align: center;
            margin-bottom: 50px;
        }

        .selection-title h2 {
            font-size: 2.2rem;
            margin-bottom: 15px;
        }

        .selection-title p {
            color: var(--medium-gray);
            max-width: 700px;
            margin: 0 auto;
        }

        .test-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .test-option {
            background: var(--light-gray);
            border-radius: var(--border-radius);
            padding: 40px 30px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            border: 2px solid transparent;
            text-decoration: none;
            color: inherit;
            display: block;
        }

        .test-option:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-blue);
        }

        .option-icon {
            font-size: 3rem;
            margin-bottom: 25px;
        }

        .test-option-1 .option-icon {
            color: var(--green);
        }

        .test-option-2 .option-icon {
            color: var(--orange);
        }

        .test-option h3 {
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .test-option p {
            color: var(--medium-gray);
            margin-bottom: 20px;
        }

        /* Test Section */
        .test-section {
            padding: 60px 0;
            display: none;
            flex: 1;
        }

        .test-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-light-blue) 100%);
            color: var(--white);
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .test-info h2 {
            color: var(--white);
            margin-bottom: 10px;
        }

        .test-stats {
            text-align: right;
        }

        .test-stats div {
            margin-bottom: 5px;
        }

        /* Question Container */
        .question-container {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-gray);
        }

        .question-number {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-blue);
        }

        .question-text {
            font-size: 1.3rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        /* 分类标签样式 */
        .category-tag {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .category-tag i {
            margin-right: 8px;
        }

        .category-mises-en-situation {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .category-laicite {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }

        .category-devise-et-symboles {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
        }

        /* Options */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        .option {
            padding: 18px 20px;
            background-color: var(--light-gray);
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 15px;
            user-select: none;
        }

        .option:hover {
            background-color: #e9ecef;
            border-color: var(--primary-blue);
        }

        .option.selected {
            background-color: rgba(0, 102, 204, 0.1);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
            font-weight: 600;
        }

        .option.correct {
            background-color: rgba(39, 174, 96, 0.1);
            border-color: var(--green);
            color: var(--green);
        }

        .option.incorrect {
            background-color: rgba(231, 76, 60, 0.1);
            border-color: var(--red);
            color: var(--red);
        }

        .option-letter {
            width: 35px;
            height: 35px;
            background-color: var(--primary-blue);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }

        .option-text {
            flex: 1;
        }

        /* Explanation Section */
        .explanation-section {
            background-color: rgba(0, 64, 128, 0.05);
            border-left: 4px solid var(--primary-blue);
            padding: 25px;
            border-radius: 0 8px 8px 0;
            margin-top: 30px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .explanation-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .correct-answer {
            font-weight: 600;
            color: var(--green);
            margin-bottom: 15px;
        }

        .explanation-text {
            color: var(--dark-gray);
        }

        /* Navigation Buttons */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }

        /* Results Section */
        .results-section {
            padding: 60px 0;
            display: none;
            flex: 1;
        }

        .results-card {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 50px;
            box-shadow: var(--shadow);
            text-align: center;
            animation: fadeIn 0.5s ease-out;
        }

        .results-icon {
            font-size: 4rem;
            margin-bottom: 30px;
        }

        .results-success .results-icon {
            color: var(--green);
        }

        .results-warning .results-icon {
            color: var(--orange);
        }

        .results-fail .results-icon {
            color: var(--red);
        }

        .results-card h2 {
            margin-bottom: 20px;
        }

        .score-display {
            font-size: 4.5rem;
            font-weight: 700;
            margin: 30px 0;
            color: var(--primary-blue);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .score-display span {
            display: inline-block;
        }

        .score-display .score-separator {
            font-size: 3rem;
            color: var(--medium-gray);
        }

        .score-display .total-questions {
            font-size: 3rem;
            color: var(--medium-gray);
        }

        .results-message {
            font-size: 1.2rem;
            margin-bottom: 40px;
            color: var(--medium-gray);
        }

        .results-details {
            text-align: left;
            margin-bottom: 40px;
        }

        .result-item {
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--green);
            animation: fadeIn 0.5s ease-out;
        }

        .result-item.incorrect {
            border-left-color: var(--red);
            background-color: rgba(231, 76, 60, 0.05);
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            background-color: var(--light-gray);
            border-radius: 10px;
            margin: 20px 0;
            height: 10px;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary-blue);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        /* Buttons */
        .btn {
            display: inline-block;
            padding: 16px 36px;
            background-color: var(--primary-yellow);
            color: var(--primary-blue);
            border: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            box-shadow: var(--shadow);
            text-decoration: none;
            min-height: 54px;
            position: relative;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .btn:hover {
            background-color: var(--primary-light-yellow);
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .btn-primary {
            background-color: var(--primary-blue);
            color: var(--white);
        }

        .btn-primary:hover {
            background-color: var(--primary-light-blue);
        }

        .btn-success {
            background-color: var(--green);
            color: var(--white);
        }

        .btn-success:hover {
            background-color: #229954;
        }

        .btn-block {
            width: 100%;
        }

        /* Welcome Message */
        .welcome-message {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(0, 64, 128, 0.1) 0%, rgba(0, 102, 204, 0.1) 100%);
            border-radius: var(--border-radius);
        }

        .welcome-message h3 {
            color: var(--primary-blue);
            margin-bottom: 10px;
        }

        /* Footer */
        .main-footer {
            background-color: var(--primary-blue);
            color: var(--white);
            padding: 60px 0 30px;
            margin-top: auto;
            flex-shrink: 0;
            width: 100%;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-column h4 {
            color: var(--primary-yellow);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 10px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
            display: inline-block;
            padding: 2px 0;
        }

        .footer-links a:hover {
            color: var(--primary-yellow);
            padding-left: 5px;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .contact-item i {
            color: var(--primary-yellow);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            opacity: 0.7;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-header h1 {
                font-size: 2.2rem;
            }
            
            .nav-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-links {
                gap: 20px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .login-card {
                padding: 30px 20px;
            }
            
            .test-options {
                grid-template-columns: 1fr;
            }
            
            .test-header {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .test-stats {
                text-align: center;
            }
            
            .question-container {
                padding: 25px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn {
                width: 100%;
            }
            
            .score-display {
                font-size: 3.5rem;
            }
            
            .score-display .total-questions {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 480px) {
            .main-header h1 {
                font-size: 1.8rem;
            }
            
            .btn {
                padding: 14px 25px;
                font-size: 1rem;
            }
            
            .option {
                padding: 15px;
                font-size: 1rem;
            }
            
            .login-card {
                padding: 20px 15px;
            }
            
            .score-display {
                font-size: 3rem;
            }
            
            .score-display .total-questions {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="container">
            <h1>Test Rapide - Principes et valeurs de la République</h1>
            <p>Association Mille Voiles - Évaluez vos connaissances sur les principes et valeurs républicaines</p>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="main-nav">
        <div class="container nav-container">
            <a href="thematique-valeurs.html" class="logo">
                <i class="fas fa-arrow-left"></i>
                <span>Retour à la thématique</span>
            </a>
            <div class="nav-links">
                <a href="index.html">Accueil</a>
                <a href="test-civique.html">Test Civique</a>
                <a href="astuces-examen.html">Astuces</a>
            </div>
        </div>
    </nav>

    <!-- Login Section -->
    <section class="login-section" id="loginSection">
        <div class="container login-wrapper">
            <div class="login-card">
                <div class="login-icon">
                    <i class="fas fa-user-graduate"></i>
                </div>
                <h2>Accès au test rapide</h2>
                <p>Veuillez entrer vos identifiants pour accéder au test</p>
                
                <div class="welcome-message">
                    <h3>Bienvenue, étudiant !</h3>
                    <p>Connectez-vous avec votre nom d'utilisateur et mot de passe pour commencer le test.</p>
                </div>
                
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">Nom d'utilisateur</label>
                        <input type="text" id="username" placeholder="Entrez votre nom d'utilisateur" required>
                        <div class="error-message" id="usernameError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Mot de passe</label>
                        <input type="password" id="password" placeholder="Entrez votre mot de passe" required>
                        <div class="error-message" id="passwordError"></div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-block" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i> Se connecter
                    </button>
                </form>
            </div>
        </div>
    </section>

    <!-- Test Type Selection -->
    <section class="test-selection" id="testSelection">
        <div class="container">
            <div class="selection-title">
                <h2 id="welcomeStudent">Choisissez votre type d'examen</h2>
                <p>Sélectionnez le type d'examen que vous préparez pour commencer immédiatement le test</p>
            </div>
            
            <div class="test-options">
                <a href="javascript:void(0)" class="test-option test-option-1" data-type="pluriannuel">
                    <div class="option-icon">
                        <i class="fas fa-id-card"></i>
                    </div>
                    <h3>Carte de séjour pluriannuelle</h3>
                    <p>Test de 20 questions adapté aux personnes demandant une carte de séjour pluriannuelle (4 ans).</p>
                    <div class="btn btn-success">Commencer ce test</div>
                </a>
                
                <a href="javascript:void(0)" class="test-option test-option-2" data-type="resident">
                    <div class="option-icon">
                        <i class="fas fa-passport"></i>
                    </div>
                    <h3>Carte de résident (10 ans)</h3>
                    <p>Test de 20 questions pour la carte de résident de 10 ans. Questions plus approfondies.</p>
                    <div class="btn btn-success">Commencer ce test</div>
                </a>
            </div>
        </div>
    </section>

    <!-- Test Section -->
    <section class="test-section" id="testSection">
        <div class="container">
            <div class="test-header">
                <div class="test-info">
                    <h2 id="testTypeTitle">Test Rapide</h2>
                    <p id="testTheme">Principes et valeurs de la République</p>
                    <p id="studentNameDisplay" style="font-size: 0.9rem; opacity: 0.9; margin-top: 5px;"></p>
                </div>
                <div class="test-stats">
                    <div><strong>Question :</strong> <span id="currentQuestion">1</span>/<span id="totalQuestions">20</span></div>
                    <div><strong>Score :</strong> <span id="currentScore">0</span>/20</div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 10%"></div>
            </div>
            
            <div class="question-container" id="questionContainer">
                <div class="question-header">
                    <div class="question-number">Question <span id="questionNum">1</span>/<span id="totalQuestions2">20</span></div>
                    <div style="color: var(--primary-blue); font-weight: 600;" id="questionStatus">Non répondue</div>
                </div>
                
                <div class="question-text" id="questionText">
                    Chargement de la question...
                </div>
                
                <div class="options-container" id="optionsContainer">
                    <!-- Options will be added by JavaScript -->
                </div>
                
                <div class="explanation-section" id="explanationSection">
                    <div class="explanation-title">Explication</div>
                    <div class="correct-answer" id="correctAnswerText"></div>
                    <div class="explanation-text" id="explanationText"></div>
                </div>
            </div>
            
            <div class="navigation-buttons">
                <button class="btn" id="prevBtn" disabled>
                    <i class="fas fa-arrow-left"></i> Question précédente
                </button>
                
                <div style="display: flex; gap: 15px;">
                    <button class="btn btn-primary" id="checkAnswerBtn">
                        <i class="fas fa-check-circle"></i> Vérifier la réponse
                    </button>
                    
                    <button class="btn btn-success" id="nextBtn">
                        Question suivante <i class="fas fa-arrow-right"></i>
                    </button>

                    <button class="btn btn-primary" id="finishTestBtn" style="display: none;">
                        <i class="fas fa-flag-checkered"></i> Terminer et voir les résultats
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section class="results-section" id="resultsSection">
        <div class="container">
            <div class="results-card" id="resultsCard">
                <div class="results-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                
                <h2 id="resultsTitle">Résultats du test</h2>
                
                <div class="score-display">
                    <span id="finalScore">0</span>
                    <span class="score-separator">/</span>
                    <span class="total-questions" id="finalTotal">20</span>
                </div>
                
                <div class="results-message" id="resultsMessage">
                    Chargement de vos résultats...
                </div>
                
                <div class="results-details" id="resultsDetails">
                    <!-- Results details will be added by JavaScript -->
                </div>
                
                <div style="display: flex; gap: 15px; justify-content: center;">
                    <button class="btn btn-primary" id="retryTestBtn">
                        <i class="fas fa-redo"></i> Refaire le test
                    </button>
                    <a href="thematique-valeurs.html" class="btn">
                        <i class="fas fa-book"></i> Revoir la leçon
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <!-- About Column -->
                <div class="footer-column">
                    <h4>À propos</h4>
                    <p>
                        L'association Mille Voiles accompagne les communautés chinoises en France dans leurs démarches d'intégration, d'apprentissage du français et de préparation aux examens officiels.
                    </p>
                </div>
                
                <!-- Quick Links Column -->
                <div class="footer-column">
                    <h4>Liens rapides</h4>
                    <ul class="footer-links">
                        <li><a href="thematique-valeurs.html"><i class="fas fa-chevron-right"></i> Principes et valeurs de la République</a></li>
                        <li><a href="astuces-examen.html"><i class="fas fa-chevron-right"></i> Astuces pour l'examen</a></li>
                        <li><a href="test-civique.html"><i class="fas fa-chevron-right"></i> Test Civique complet</a></li>
                        <li><a href="index.html"><i class="fas fa-chevron-right"></i> Page d'accueil</a></li>
                    </ul>
                </div>
                
                <!-- Contact Column -->
                <div class="footer-column">
                    <h4>Contact</h4>
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>2025qianfan@gmail.com</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-globe"></i>
                            <span>Association Mille Voiles</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>36 Allée des Plantes, 94800 Villejuif</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Association Mille Voiles / 千帆协会 - Tous droits réservés.</p>
            </div>
        </div>
    </footer>
<script src="question10.js"></script>
<script src="question4.js"></script>
<script src="compte.js"></script>
    <!-- JavaScript -->
    <script>
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
        });

        // 禁止常见快捷键
        document.addEventListener('keydown', function (e) {
            // Ctrl + C / Ctrl + U / Ctrl + S / Ctrl + A / Ctrl + X
            if (e.ctrlKey && ['c', 'u', 's', 'x', 'v', 'a'].includes(e.key.toLowerCase())) {
                e.preventDefault();
            }

            // F12
            if (e.key === 'F12') {
                e.preventDefault();
            }
        });

        // 学生数据库
       

        // 题库数据
        const allQuestions = [...questionsFourYears, ...questionsTenYears];

        function pickRandomByCategory(questions, category, count) {
            const filtered = questions.filter(q => q.category === category);

            if (filtered.length < count) {
                console.warn(`分类 ${category} 题目不足：需要 ${count}，只有 ${filtered.length}`);
            }

            return filtered
                .sort(() => Math.random() - 0.5)
                .slice(0, count);
        };

        const questionBanks = {
            pluriannuel: () => {
                return [
                    ...pickRandomByCategory(questionsFourYears, "Devise et symboles", 8),
                    ...pickRandomByCategory(questionsFourYears, "Laïcité", 2),
                    ...pickRandomByCategory(questionsFourYears, "Mises en situation", 10)
                ].sort(() => Math.random() - 0.5);
            },

            resident: () => {
                return [
                    ...pickRandomByCategory(allQuestions, "Devise et symboles", 8),
                    ...pickRandomByCategory(allQuestions, "Laïcité", 2),
                    ...pickRandomByCategory(allQuestions, "Mises en situation", 10)
                ].sort(() => Math.random() - 0.5);
            }
        };

        // 应用程序状态
        let currentTestType = null;
        let selectedQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let questionAnswered = [];
        let score = 0;
        let currentStudent = null;
        let isAnswerChecked = false;
        let questionScored = [];

        questionScored = new Array(selectedQuestions.length).fill(false);       

        // DOM 元素
        const loginSection = document.getElementById('loginSection');
        const testSelection = document.getElementById('testSelection');
        const testSection = document.getElementById('testSection');
        const resultsSection = document.getElementById('resultsSection');
        const loginForm = document.getElementById('loginForm');
        const testOptions = document.querySelectorAll('.test-option');
        const welcomeStudent = document.getElementById('welcomeStudent');
        const testTypeTitle = document.getElementById('testTypeTitle');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const explanationSection = document.getElementById('explanationSection');
        const correctAnswerText = document.getElementById('correctAnswerText');
        const explanationText = document.getElementById('explanationText');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const checkAnswerBtn = document.getElementById('checkAnswerBtn');
        const finishTestBtn = document.getElementById('finishTestBtn');
        const questionNum = document.getElementById('questionNum');
        const totalQuestions = document.getElementById('totalQuestions');
        const totalQuestions2 = document.getElementById('totalQuestions2');
        const currentScore = document.getElementById('currentScore');
        const questionStatus = document.getElementById('questionStatus');
        const progressBar = document.getElementById('progressBar');
        const finalScore = document.getElementById('finalScore');
        const finalTotal = document.getElementById('finalTotal');
        const resultsMessage = document.getElementById('resultsMessage');
        const resultsDetails = document.getElementById('resultsDetails');
        const resultsCard = document.getElementById('resultsCard');
        const retryTestBtn = document.getElementById('retryTestBtn');

        // 辅助函数：根据分类获取CSS类名
        function getCategoryClass(category) {
            switch(category) {
                case "Mises en situation":
                    return "category-mises-en-situation";
                case "Laïcité":
                    return "category-laicite";
                case "Devise et symboles":
                    return "category-devise-et-symboles";
                default:
                    return "";
            }
        }

        // 登录功能
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const usernameError = document.getElementById('usernameError');
            const passwordError = document.getElementById('passwordError');
            
            // 重置错误信息
            usernameError.style.display = 'none';
            passwordError.style.display = 'none';
            
            // 查找学生
            const student = students.find(s => 
                s.name.toLowerCase() === username.toLowerCase() || 
                s.name === username
            );
            
            if (!student) {
                usernameError.textContent = "Nom d'utilisateur incorrect";
                usernameError.style.display = 'block';
                return;
            }
            
            if (student.password !== password) {
                passwordError.textContent = "Mot de passe incorrect";
                passwordError.style.display = 'block';
                return;
            }
            
            // 登录成功
            currentStudent = student;
            loginSection.style.display = 'none';
            testSelection.style.display = 'block';
            
            // 更新欢迎信息
            welcomeStudent.textContent = `Bienvenue, ${student.name} ! Choisissez votre type d'examen`;
        });

        // 选择考试类型 - 直接开始测试
        testOptions.forEach(option => {
            option.addEventListener('click', function(e) {
                e.preventDefault();
                
                // 保存选择的考试类型
                currentTestType = this.getAttribute('data-type');
                
                // 开始测试
                startTest();
            });
        });

        // 开始测试
        function startTest() {
            // 根据考试类型选择题目
            selectedQuestions = questionBanks[currentTestType]();
            
            // 初始化用户答案数组
            userAnswers = new Array(selectedQuestions.length).fill(null);
            questionAnswered = new Array(selectedQuestions.length).fill(false);
            
            // 重置分数
            score = 0;
            currentQuestionIndex = 0;
            isAnswerChecked = false;
            
            // 显示测试部分
            testSelection.style.display = 'none';
            testSection.style.display = 'block';
            
            // 显示学生姓名
            studentNameDisplay.textContent = `Étudiant: ${currentStudent.name}`;
            
            // 更新测试类型标题
            if (currentTestType === 'pluriannuel') {
                testTypeTitle.textContent = 'Test - Carte de séjour pluriannuelle';
            } else {
                testTypeTitle.textContent = 'Test - Carte de résident (10 ans)';
            }
            
            // 更新题目总数
            totalQuestions.textContent = selectedQuestions.length;
            totalQuestions2.textContent = selectedQuestions.length;
            
            // 重置分数显示
            currentScore.textContent = '0';
            
            // 加载第一题
            loadQuestion(currentQuestionIndex);
        }

        // 加载题目
        function loadQuestion(index) {
            const question = selectedQuestions[index];
            
            // 更新问题编号
            questionNum.textContent = index + 1;
            
            // 更新问题文本 - 显示分类标签
            const categoryClass = getCategoryClass(question.category);
            questionText.innerHTML = `
                <div class="category-tag ${categoryClass}">
                    <i class="fas fa-tag"></i>
                    ${question.category}
                </div>
                <div style="font-size: 1.3rem; line-height: 1.6; margin-top: 20px;">
                    ${question.question}
                </div>
            `;
            
            // 清除选项容器
            optionsContainer.innerHTML = '';
            
            // 重置答案检查状态
            isAnswerChecked = questionAnswered[index];
            
            // 创建选项
            const letters = ['A', 'B', 'C', 'D'];
            question.options.forEach((option, optionIndex) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.dataset.index = optionIndex;
                
                // 添加选项字母
                const optionLetter = document.createElement('div');
                optionLetter.className = 'option-letter';
                optionLetter.textContent = letters[optionIndex];
                
                // 添加选项文本
                const optionText = document.createElement('div');
                optionText.className = 'option-text';
                optionText.textContent = option;
                
                // 组装选项
                optionElement.appendChild(optionLetter);
                optionElement.appendChild(optionText);
                
                // 如果用户已经回答了这个问题，显示选择状态
                if (userAnswers[index] === optionIndex) {
                    optionElement.classList.add('selected');
                    
                    // 如果已经检查过答案，显示正确/错误状态
                    if (questionAnswered[index]) {
                        if (optionIndex === question.answer) {
                            optionElement.classList.add('correct');
                        } else {
                            optionElement.classList.add('incorrect');
                        }
                    }
                }
                
                // 添加点击事件
                optionElement.addEventListener('click', function() {
                    // 只有在没有检查过答案的情况下才能选择
                    if (!questionAnswered[index]) {
                        selectOption(optionElement, index, optionIndex);
                    }
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            // 更新导航按钮状态
            prevBtn.disabled = index === 0;
            nextBtn.disabled = index === selectedQuestions.length - 1;
            
            // 更新完成测试按钮显示
            finishTestBtn.style.display = index === selectedQuestions.length - 1 ? 'inline-block' : 'none';
            nextBtn.style.display = index === selectedQuestions.length - 1 ? 'none' : 'inline-block';
            
            // 更新检查答案按钮状态
            checkAnswerBtn.disabled = userAnswers[index] === null || questionAnswered[index];
            
            // 更新问题状态
            updateQuestionStatus(index);
            
            // 显示或隐藏解释部分
            if (questionAnswered[index]) {
                showExplanation(index);
            } else {
                explanationSection.style.display = 'none';
            }
            
            // 更新进度条
            updateProgressBar(index);
        }

        // 选择选项
        function selectOption(optionElement, questionIndex, optionIndex) {
            // 移除所有选项的选中状态
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // 添加选中状态到当前选项
            optionElement.classList.add('selected');
            
            // 保存用户答案
            userAnswers[questionIndex] = optionIndex;
            
            // 更新问题状态
            updateQuestionStatus(questionIndex);
            
            // 启用检查答案按钮
            checkAnswerBtn.disabled = false;
        }

        // 更新问题状态
        function updateQuestionStatus(index) {
            if (userAnswers[index] === null) {
                questionStatus.textContent = 'Non répondue';
                questionStatus.style.color = 'var(--medium-gray)';
            } else if (questionAnswered[index]) {
                questionStatus.textContent = 'Réponse vérifiée';
                questionStatus.style.color = 'var(--green)';
            } else {
                questionStatus.textContent = 'Réponse sélectionnée';
                questionStatus.style.color = 'var(--primary-blue)';
            }
        }

        // 更新进度条
        function updateProgressBar(index) {
            const progress = ((index + 1) / selectedQuestions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // 检查答案
        checkAnswerBtn.addEventListener('click', function() {
            const currentQuestion = selectedQuestions[currentQuestionIndex];
            const userAnswer = userAnswers[currentQuestionIndex];
            
            if (userAnswer === null) {
                alert('Veuillez sélectionner une réponse avant de vérifier.');
                return;
            }
            
            // 标记问题已回答
            questionAnswered[currentQuestionIndex] = true;
            
            // 显示解释
            showExplanation(currentQuestionIndex);
            
            // 禁用检查答案按钮
            this.disabled = true;
            
            // 如果答案正确，增加分数 - 修复：只有当答案正确时才增加分数
         if (!questionScored[currentQuestionIndex]) {
            if (userAnswer === currentQuestion.answer) {
                score++;
            }
            questionScored[currentQuestionIndex] = true;
            currentScore.textContent = score;
        }

            // 更新问题状态
            updateQuestionStatus(currentQuestionIndex);
            
            // 如果是最后一题，显示完成测试按钮
            if (currentQuestionIndex === selectedQuestions.length - 1) {
                finishTestBtn.style.display = 'inline-block';
                nextBtn.style.display = 'none';
            }
        });

        // 显示解释
        function showExplanation(index) {
            const question = selectedQuestions[index];
            const userAnswer = userAnswers[index];
            const letters = ['A', 'B', 'C', 'D'];
            
            correctAnswerText.textContent = `La bonne réponse est: ${letters[question.answer]}. ${question.options[question.answer]}`;
            explanationText.textContent = question.explanation;
            explanationSection.style.display = 'block';
            
            // 更新选项样式
            const options = document.querySelectorAll('.option');
            options.forEach(option => {
                const optionIndex = parseInt(option.dataset.index);
                
                if (optionIndex === question.answer) {
                    option.classList.add('correct');
                } else if (optionIndex === userAnswer && optionIndex !== question.answer) {
                    option.classList.add('incorrect');
                }
            });
        }

        // 上一题
        prevBtn.addEventListener('click', function() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            }
        });

        // 下一题
        nextBtn.addEventListener('click', function() {
            if (currentQuestionIndex < selectedQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            }
        });

        // 完成测试
        finishTestBtn.addEventListener('click', function() {
            // 显示结果部分
            testSection.style.display = 'none';
            resultsSection.style.display = 'block';
            
            // 计算最终得分 - 修复：使用正确的分数变量
         // ===== 最终成绩：重新按所有题目计算（不管点没点 Vérifier）=====
            let finalScoreCount = 0;
            const totalQuestionsCount = selectedQuestions.length;

            selectedQuestions.forEach((question, index) => {
                if (userAnswers[index] === question.answer) {
                    finalScoreCount++;
                }
            });

// 更新分数显示
finalScore.textContent = finalScoreCount;
finalTotal.textContent = totalQuestionsCount;

const percentage = (finalScoreCount / totalQuestionsCount) * 100;

            
            // 显示结果消息
            let message = '';
            let iconClass = '';
            
            if (percentage >= 80) {
                message = `Félicitations ${currentStudent.name} ! Vous avez réussi le test avec un excellent score (${score}/${totalQuestionsCount}, ${percentage.toFixed(1)}%). Vous avez de solides connaissances sur les valeurs de la République.`;
                iconClass = 'results-success';
            } else if (percentage >= 60) {
                message = `Bon résultat ${currentStudent.name} ! Vous avez obtenu ${score}/${totalQuestionsCount} (${percentage.toFixed(1)}%). Vous avez une bonne connaissance des valeurs républicaines, mais certains points méritent d'être revus.`;
                iconClass = 'results-warning';
            } else {
                message = `${currentStudent.name}, vous avez obtenu ${score}/${totalQuestionsCount} (${percentage.toFixed(1)}%). Nous vous recommandons de consulter à nouveau la leçon et de refaire le test pour améliorer votre score.`;
                iconClass = 'results-fail';
            }
            
            resultsMessage.textContent = message;
            resultsCard.className = `results-card ${iconClass}`;
            
            // 显示详细结果
            let detailsHTML = '<h3 style="margin-bottom: 20px;">Détail de vos réponses :</h3>';
            
            selectedQuestions.forEach((question, index) =>{
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.answer;
                const letters = ['A', 'B', 'C', 'D'];
                const categoryClass = getCategoryClass(question.category);
                
                detailsHTML += `
                    <div class="result-item ${isCorrect ? '' : 'incorrect'}">
                        <div class="category-tag ${categoryClass}" style="font-size: 0.75rem; padding: 4px 10px; margin-bottom: 10px;">
                            <i class="fas fa-tag"></i>
                            ${question.category}
                        </div>
                        <p><strong>Question ${index + 1}:</strong> ${question.question}</p>
                        <p><strong>Votre réponse:</strong> ${userAnswer !== null ? letters[userAnswer] + '. ' + question.options[userAnswer] : 'Non répondue'}</p>
                        <p><strong>Réponse correcte:</strong> ${letters[question.answer]}. ${question.options[question.answer]}</p>
                        <p><strong>Explication:</strong> ${question.explanation}</p>
                    </div>
                `;
            });
            
            resultsDetails.innerHTML = detailsHTML;
        });

        // 重新测试
        retryTestBtn.addEventListener('click', function() {
            // 重置状态
            currentQuestionIndex = 0;
            userAnswers = new Array(selectedQuestions.length).fill(null);
            questionAnswered = new Array(selectedQuestions.length).fill(false);
            score = 0;
            isAnswerChecked = false;
            
            // 重置显示
            resultsSection.style.display = 'none';
            testSection.style.display = 'block';
            
            // 重置分数显示
            currentScore.textContent = '0';
            
            // 重新加载第一题
            loadQuestion(currentQuestionIndex);
        });

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 确保登录部分可见
            loginSection.style.display = 'flex';
            testSelection.style.display = 'none';
            testSection.style.display = 'none';
            resultsSection.style.display = 'none';
            
            // 调整登录区域高度
            adjustLoginSectionHeight();
            
            // 窗口大小改变时重新调整
            window.addEventListener('resize', adjustLoginSectionHeight);
        });

        // 防止脚部遮挡函数
        function adjustLoginSectionHeight() {
            const loginSection = document.querySelector('.login-section');
            const footer = document.querySelector('.main-footer');
            
            if (loginSection && footer) {
                const footerHeight = footer.offsetHeight;
                const headerHeight = document.querySelector('.main-header').offsetHeight;
                const navHeight = document.querySelector('.main-nav').offsetHeight;
                
                // 计算可用高度
                const availableHeight = window.innerHeight - headerHeight - navHeight - footerHeight;
                
                // 设置最小高度
                const minHeight = Math.max(availableHeight, 300);
                loginSection.style.minHeight = minHeight + 'px';
                
                // 确保内容垂直居中
                const loginWrapper = document.querySelector('.login-wrapper');
                if (loginWrapper) {
                    if (availableHeight < 500) {
                        loginWrapper.style.alignItems = 'flex-start';
                        loginWrapper.style.paddingTop = '40px';
                    } else {
                        loginWrapper.style.alignItems = 'center';
                        loginWrapper.style.paddingTop = '0';
                    }
                }
            }
        }
    </script>
</body>
</html>
